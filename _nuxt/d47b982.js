(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{326:function(e,t,r){"use strict";r.r(t);r(7),r(139),r(21),r(44);var n=r(14),o={layout:"admin",data:function(){return{loading:!1,saving:!1,fields:["index",{key:"name",label:"Nombre",sortable:!0},{key:"email",label:"Correo",sortable:!0},{key:"password",label:"Contraseña",sortable:!1},"actions"],items:[],form:{id:null,name:null,email:null,password:null},collection:this.$fire.firestore.collection("users"),indexEdit:null}},mounted:function(){this.getItems()},methods:{open:function(){var data=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;null===data?(this.indexEdit=null,this.resetForm()):(this.indexEdit=data.index,this.form=Object.assign({},data.item)),this.$bvModal.show("modal-form")},close:function(){this.indexEdit=null,this.resetForm(),this.$bvModal.hide("modal-form")},resetForm:function(){this.form.id=null,this.form.name=null,this.form.email=null,this.form.password=null},getItem:function(e){var t=this;return Object(n.a)(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,t.collection.doc(e).get();case 3:if(!(n=r.sent).exists){r.next=6;break}return r.abrupt("return",n);case 6:r.next=11;break;case 8:r.prev=8,r.t0=r.catch(0),t.$bvToast.toast("No se pudo recuperar el recurso",{title:"Error",variant:"danger",solid:!0});case 11:return r.abrupt("return",null);case 12:case"end":return r.stop()}}),r,null,[[0,8]])})))()},getItems:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.loading=!0,t.prev=1,t.next=4,e.collection.get();case 4:t.sent.docs.map((function(t){var data=t.data();data.id=t.id,e.items.push(data)})),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),e.$bvToast.toast("No se pudo recuperar los datos",{title:"Error",variant:"danger",solid:!0});case 11:e.loading=!1;case 12:case"end":return t.stop()}}),t,null,[[1,8]])})))()},store:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var r,n,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.saving=!0,t.prev=1,t.next=4,e.collection.add({name:e.form.name,email:e.form.email,password:e.form.password});case 4:return r=t.sent,t.next=7,e.getItem(r.id);case 7:null!==(n=t.sent)&&((o=n.data()).id=n.id,e.items.unshift(o)),e.close(),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(1),e.$bvToast.toast("No se pudo guardar el usuario",{title:"Error",variant:"danger",solid:!0});case 15:e.saving=!1;case 16:case"end":return t.stop()}}),t,null,[[1,12]])})))()},update:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var r,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.saving=!0,t.prev=1,t.next=4,e.collection.doc(e.form.id).set({name:e.form.name,email:e.form.email,password:e.form.password});case 4:return t.sent,t.next=7,e.getItem(e.form.id);case 7:null!==(r=t.sent)&&((n=r.data()).id=r.id,e.items.splice(e.indexEdit,1,n)),e.close(),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(1),e.$bvToast.toast("No se pudo actualizar el usuario",{title:"Error",variant:"danger",solid:!0});case 15:e.saving=!1;case 16:case"end":return t.stop()}}),t,null,[[1,12]])})))()},destroy:function(data){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(window.confirm("Desea eliminar al usuario: ".concat(data.item.name))){t.next=3;break}return t.abrupt("return");case 3:return e.saving=!0,t.prev=4,t.next=7,e.collection.doc(data.item.id).delete();case 7:t.sent,e.items.splice(data.index,1),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(4),e.$bvToast.toast("No se pudo eliminar el usuario",{title:"Error",variant:"danger",solid:!0});case 14:e.saving=!1;case 15:case"end":return t.stop()}}),t,null,[[4,11]])})))()}}},l=r(35),component=Object(l.a)(o,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("b-card",{staticClass:"text-center",attrs:{"bg-variant":"light","body-class":"p-0"},scopedSlots:e._u([{key:"header",fn:function(){return[r("h4",{staticClass:"mb-0"},[e._v("Usuarios\n\n                "),r("b-button",{attrs:{pill:"",variant:"primary",size:"sm"},on:{click:function(t){return e.open()}}},[e._v("Nuevo")])],1)]},proxy:!0}])},[e._v(" "),r("b-card-text",[r("b-table",{attrs:{small:"",hover:"",stacked:"sm",fields:e.fields,items:e.items,busy:e.loading},scopedSlots:e._u([{key:"cell(index)",fn:function(data){return[e._v("\n                    "+e._s(data.index+1)+"\n                ")]}},{key:"cell(actions)",fn:function(data){return[r("b-dropdown",{staticClass:"m-md-2",attrs:{size:"sm",right:"",text:"Accion",variant:"outline-secondary"}},[r("b-dropdown-item",{on:{click:function(t){return e.open(data)}}},[e._v("Editar")]),e._v(" "),r("b-dropdown-item",{on:{click:function(t){return e.destroy(data)}}},[e._v("Elimnar")])],1)]}},{key:"table-busy",fn:function(){return[r("div",{staticClass:"text-center text-danger my-2"},[r("b-spinner",{staticClass:"align-middle"}),e._v(" "),r("strong",[e._v("Cargando...")])],1)]},proxy:!0}])})],1)],1),e._v(" "),r("b-modal",{attrs:{id:"modal-form","hide-footer":"",title:"Usuario"}},[r("b-form",{on:{submit:e.update}},[r("b-form-group",{attrs:{label:"Nombre*","label-for":"name"}},[r("b-form-input",{attrs:{id:"name",type:"text"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),r("b-form-group",{attrs:{label:"Correo*","label-for":"email"}},[r("b-form-input",{attrs:{id:"email",type:"text"},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1),e._v(" "),r("b-form-group",{attrs:{label:"Contraseña*","label-for":"password"}},[r("b-form-input",{attrs:{id:"password",type:"text"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),e._v(" "),null===e.form.id?r("b-button",{staticClass:"mt-3",attrs:{variant:"outline-primary",block:"",disabled:this.saving},on:{click:e.store}},[e._v("Guardar")]):r("b-button",{staticClass:"mt-3",attrs:{variant:"outline-success",block:"",disabled:this.saving},on:{click:e.update}},[e._v("Actualizar")])],1)],1)],1)}),[],!1,null,null,null);t.default=component.exports}}]);